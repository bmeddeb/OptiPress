{
  "version": 3,
  "sources": ["../../src/js/attachment-edit.js"],
  "sourcesContent": ["/**\n * OptiPress Attachment Edit Page\n *\n * Handles conversion controls on individual attachment edit page.\n *\n * @package OptiPress\n */\n\n(function ($) {\n\t'use strict';\n\n\tvar processing = false;\n\n\t$(document).ready(function () {\n\t\t// Convert Image button\n\t\t$('#optipress-meta-box-content').on('click', '.optipress-convert-image', function (e) {\n\t\t\te.preventDefault();\n\n\t\t\tif (processing) return;\n\n\t\t\tvar $button = $(this);\n\t\t\tvar attachmentId = $('#optipress-meta-box-content').data('attachment-id');\n\t\t\tvar format = $('input[name=\"optipress_format\"]:checked').val();\n\n\t\t\tif (!format) {\n\t\t\t\talert(optipressAttachment.i18n.error + ': No format selected.');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconvertImage(attachmentId, format);\n\t\t});\n\n\t\t// Revert Image button\n\t\t$('#optipress-meta-box-content').on('click', '.optipress-revert-image', function (e) {\n\t\t\te.preventDefault();\n\n\t\t\tif (processing) return;\n\n\t\t\tif (!confirm(optipressAttachment.i18n.confirmRevert)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tvar attachmentId = $('#optipress-meta-box-content').data('attachment-id');\n\t\t\trevertImage(attachmentId);\n\t\t});\n\n\t\t// Switch Format button\n\t\t$('#optipress-meta-box-content').on('click', '.optipress-switch-format', function (e) {\n\t\t\te.preventDefault();\n\n\t\t\tif (processing) return;\n\n\t\t\tvar $button = $(this);\n\t\t\tvar attachmentId = $('#optipress-meta-box-content').data('attachment-id');\n\t\t\tvar format = $button.data('format');\n\n\t\t\tswitchFormat(attachmentId, format);\n\t\t});\n\t});\n\n\t/**\n\t * Convert image to specified format\n\t */\n\tfunction convertImage(attachmentId, format) {\n\t\tprocessing = true;\n\t\tshowLoading(optipressAttachment.i18n.converting);\n\n\t\t$.ajax({\n\t\t\turl: optipressAttachment.ajaxUrl,\n\t\t\ttype: 'POST',\n\t\t\tdata: {\n\t\t\t\taction: 'optipress_convert_single_image',\n\t\t\t\tnonce: optipressAttachment.nonce,\n\t\t\t\tattachment_id: attachmentId,\n\t\t\t\tformat: format,\n\t\t\t},\n\t\t\tsuccess: function (response) {\n\t\t\t\tprocessing = false;\n\n\t\t\t\tif (response.success) {\n\t\t\t\t\t// Show success message using WordPress notices\n\t\t\t\t\tshowNotice(response.data.message, 'success');\n\n\t\t\t\t\t// Update meta box content\n\t\t\t\t\tif (response.data.html) {\n\t\t\t\t\t\t$('#optipress-meta-box-content').html(response.data.html);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reload attachment data in media modal if open\n\t\t\t\t\treloadAttachmentData(attachmentId);\n\t\t\t\t} else {\n\t\t\t\t\tvar errorMsg =\n\t\t\t\t\t\tresponse.data && response.data.message\n\t\t\t\t\t\t\t? response.data.message\n\t\t\t\t\t\t\t: optipressAttachment.i18n.unknownError;\n\n\t\t\t\t\tshowNotice(optipressAttachment.i18n.conversionError + ' ' + errorMsg, 'error');\n\n\t\t\t\t\thideLoading();\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function (xhr, status, error) {\n\t\t\t\tprocessing = false;\n\t\t\t\tshowNotice(optipressAttachment.i18n.error + ': ' + error, 'error');\n\t\t\t\thideLoading();\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Revert image to original\n\t */\n\tfunction revertImage(attachmentId) {\n\t\tprocessing = true;\n\t\tshowLoading(optipressAttachment.i18n.reverting);\n\n\t\t$.ajax({\n\t\t\turl: optipressAttachment.ajaxUrl,\n\t\t\ttype: 'POST',\n\t\t\tdata: {\n\t\t\t\taction: 'optipress_revert_single_image',\n\t\t\t\tnonce: optipressAttachment.nonce,\n\t\t\t\tattachment_id: attachmentId,\n\t\t\t},\n\t\t\tsuccess: function (response) {\n\t\t\t\tprocessing = false;\n\n\t\t\t\tif (response.success) {\n\t\t\t\t\t// Show success message\n\t\t\t\t\tshowNotice(response.data.message, 'success');\n\n\t\t\t\t\t// Update meta box content\n\t\t\t\t\tif (response.data.html) {\n\t\t\t\t\t\t$('#optipress-meta-box-content').html(response.data.html);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reload attachment data\n\t\t\t\t\treloadAttachmentData(attachmentId);\n\t\t\t\t} else {\n\t\t\t\t\tvar errorMsg =\n\t\t\t\t\t\tresponse.data && response.data.message\n\t\t\t\t\t\t\t? response.data.message\n\t\t\t\t\t\t\t: optipressAttachment.i18n.unknownError;\n\n\t\t\t\t\tshowNotice(errorMsg, 'error');\n\t\t\t\t\thideLoading();\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function (xhr, status, error) {\n\t\t\t\tprocessing = false;\n\t\t\t\tshowNotice(optipressAttachment.i18n.error + ': ' + error, 'error');\n\t\t\t\thideLoading();\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Switch image to different format\n\t */\n\tfunction switchFormat(attachmentId, format) {\n\t\tprocessing = true;\n\t\tshowLoading(optipressAttachment.i18n.switching);\n\n\t\t$.ajax({\n\t\t\turl: optipressAttachment.ajaxUrl,\n\t\t\ttype: 'POST',\n\t\t\tdata: {\n\t\t\t\taction: 'optipress_switch_format',\n\t\t\t\tnonce: optipressAttachment.nonce,\n\t\t\t\tattachment_id: attachmentId,\n\t\t\t\tformat: format,\n\t\t\t},\n\t\t\tsuccess: function (response) {\n\t\t\t\tprocessing = false;\n\n\t\t\t\tif (response.success) {\n\t\t\t\t\t// Show success message\n\t\t\t\t\tshowNotice(response.data.message, 'success');\n\n\t\t\t\t\t// Update meta box content\n\t\t\t\t\tif (response.data.html) {\n\t\t\t\t\t\t$('#optipress-meta-box-content').html(response.data.html);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Reload attachment data\n\t\t\t\t\treloadAttachmentData(attachmentId);\n\t\t\t\t} else {\n\t\t\t\t\tvar errorMsg =\n\t\t\t\t\t\tresponse.data && response.data.message\n\t\t\t\t\t\t\t? response.data.message\n\t\t\t\t\t\t\t: optipressAttachment.i18n.unknownError;\n\n\t\t\t\t\tshowNotice(optipressAttachment.i18n.conversionError + ' ' + errorMsg, 'error');\n\n\t\t\t\t\thideLoading();\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function (xhr, status, error) {\n\t\t\t\tprocessing = false;\n\t\t\t\tshowNotice(optipressAttachment.i18n.error + ': ' + error, 'error');\n\t\t\t\thideLoading();\n\t\t\t},\n\t\t});\n\t}\n\n\t/**\n\t * Show loading state\n\t */\n\tfunction showLoading(message) {\n\t\tvar $metaBox = $('#optipress-meta-box-content');\n\t\t$metaBox.find('.optipress-status-display').hide();\n\t\t$metaBox.find('.optipress-loading').show();\n\n\t\tif (message) {\n\t\t\t$metaBox.find('.optipress-loading-text').text(message);\n\t\t}\n\t}\n\n\t/**\n\t * Hide loading state\n\t */\n\tfunction hideLoading() {\n\t\tvar $metaBox = $('#optipress-meta-box-content');\n\t\t$metaBox.find('.optipress-loading').hide();\n\t\t$metaBox.find('.optipress-status-display').show();\n\t}\n\n\t/**\n\t * Show admin notice\n\t */\n\tfunction showNotice(message, type) {\n\t\t// Use WordPress native admin notices\n\t\tvar noticeClass = 'notice notice-' + type + ' is-dismissible';\n\t\tvar $notice = $('<div class=\"' + noticeClass + '\"><p>' + message + '</p></div>');\n\n\t\t// Insert after page title\n\t\t$('.wrap h1').first().after($notice);\n\n\t\t// Make dismissible (WordPress core handles this if wp-admin scripts are loaded)\n\t\tif (typeof wp !== 'undefined' && wp.notices) {\n\t\t\t$notice.find('.notice-dismiss').on('click', function () {\n\t\t\t\t$notice.fadeTo(100, 0, function () {\n\t\t\t\t\t$notice.slideUp(100, function () {\n\t\t\t\t\t\t$notice.remove();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\t// Auto-dismiss success notices after 5 seconds\n\t\tif (type === 'success') {\n\t\t\tsetTimeout(function () {\n\t\t\t\t$notice.fadeTo(300, 0, function () {\n\t\t\t\t\t$notice.slideUp(200, function () {\n\t\t\t\t\t\t$notice.remove();\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}, 5000);\n\t\t}\n\n\t\t// Scroll to top to show notice\n\t\t$('html, body').animate({ scrollTop: 0 }, 300);\n\t}\n\n\t/**\n\t * Reload attachment data (useful if in media modal)\n\t */\n\tfunction reloadAttachmentData(attachmentId) {\n\t\t// If we're in a media modal context, trigger refresh\n\t\tif (typeof wp !== 'undefined' && wp.media && wp.media.frame) {\n\t\t\tvar attachment = wp.media.attachment(attachmentId);\n\t\t\tif (attachment) {\n\t\t\t\tattachment.fetch();\n\t\t\t}\n\t\t}\n\t}\n})(jQuery);\n"],
  "mappings": "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",
  "names": []
}
